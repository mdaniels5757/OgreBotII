var $jscomp={scope:{},executeAsyncGenerator:function(b){function d(a){return b.next(a)}function c(a){return b.throw(a)}return new Promise(function(a,h){function g(f){f.done?a(f.value):Promise.resolve(f.value).then(d,c).then(g,h)}g(b.next())})},inherits:function(b,d){function c(){}c.prototype=d.prototype;b.prototype=new c;b.prototype.constructor=b;for(var a in d)if(Object.defineProperties){var h=Object.getOwnPropertyDescriptor(d,a);h&&Object.defineProperty(b,a,h)}else b[a]=d[a]},getGlobal:function(b){return"undefined"!=
typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,d,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[d]=c.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var d=0;return $jscomp.iteratorPrototype(function(){return d<b.length?{done:!1,value:b[d++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();var d=b[Symbol.iterator];return d?d.call(b):$jscomp.arrayIterator(b)};
$jscomp.polyfill=function(b,d,c,a){if(d){c=$jscomp.global;b=b.split(".");for(a=0;a<b.length-1;a++){var h=b[a];h in c||(c[h]={});c=c[h]}b=b[b.length-1];a=c[b];d=d(a);d!=a&&null!=d&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:d})}};$jscomp.EXPOSE_ASYNC_EXECUTOR=!0;$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(b){function d(){this.batch_=null}if(b&&!$jscomp.FORCE_POLYFILL_PROMISE)return b;d.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};d.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var c=$jscomp.global.setTimeout;d.prototype.asyncExecuteFunction=function(a){c(a,0)};d.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var f=0;f<a.length;++f){var e=a[f];delete a[f];try{e()}catch(m){this.asyncThrow_(m)}}}this.batch_=null};d.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var a=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var f=this.createResolveAndReject_();try{a(f.resolve,f.reject)}catch(e){f.reject(e)}};a.prototype.createResolveAndReject_=function(){function a(a){return function(b){e||(e=!0,a.call(f,b))}}var f=this,e=
!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};a.prototype.resolveTo_=function(b){if(b===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof a)this.settleSameAsPromise_(b);else{var f;a:switch(typeof b){case "object":f=null!=b;break a;case "function":f=!0;break a;default:f=!1}f?this.resolveToNonPromiseObj_(b):this.fulfill_(b)}};a.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(e){this.reject_(e);return}"function"==
typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};a.prototype.reject_=function(a){this.settle_(2,a)};a.prototype.fulfill_=function(a){this.settle_(1,a)};a.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};a.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),
a[b]=null;this.onSettledCallbacks_=null}};var h=new d;a.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};a.prototype.settleSameAsThenable_=function(a,b){var e=this.createResolveAndReject_();try{a.call(b,e.resolve,e.reject)}catch(m){e.reject(m)}};a.prototype.then=function(b,f){function e(a,b){return"function"==typeof a?function(b){try{c(a(b))}catch(x){d(x)}}:b}var c,d,g=new a(function(a,b){c=a;d=b});this.callWhenSettled_(e(b,c),
e(f,d));return g};a.prototype.catch=function(a){return this.then(void 0,a)};a.prototype.callWhenSettled_=function(a,b){function e(){switch(c.state_){case 1:a(c.result_);break;case 2:b(c.result_);break;default:throw Error("Unexpected state: "+c.state_);}}var c=this;null==this.onSettledCallbacks_?h.asyncExecute(e):this.onSettledCallbacks_.push(function(){h.asyncExecute(e)})};a.resolve=function(b){return b instanceof a?b:new a(function(a,e){a(b)})};a.reject=function(b){return new a(function(a,e){e(b)})};
a.race=function(b){return new a(function(c,e){for(var d=$jscomp.makeIterator(b),f=d.next();!f.done;f=d.next())a.resolve(f.value).callWhenSettled_(c,e)})};a.all=function(b){var c=$jscomp.makeIterator(b),e=c.next();return e.done?a.resolve([]):new a(function(b,d){function f(a){return function(e){m[a]=e;p--;0==p&&b(m)}}var m=[],p=0;do m.push(void 0),p++,a.resolve(e.value).callWhenSettled_(f(m.length-1),d),e=c.next();while(!e.done)})};$jscomp.EXPOSE_ASYNC_EXECUTOR&&(a.$jscomp$new$AsyncExecutor=function(){return new d});
return a},"es6-impl","es3");$jscomp.checkStringArgs=function(b,d,c){if(null==b)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(d instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return b+""};$jscomp.polyfill("String.prototype.includes",function(b){return b?b:function(b,c){return-1!==$jscomp.checkStringArgs(this,b,"includes").indexOf(b,c||0)}},"es6-impl","es3");
$jscomp.polyfill("Array.from",function(b){return b?b:function(b,c,a){$jscomp.initSymbolIterator();c=null!=c?c:function(a){return a};var d=[],g=b[Symbol.iterator];if("function"==typeof g)for(b=g.call(b);!(g=b.next()).done;)d.push(c.call(a,g.value));else for(var g=b.length,f=0;f<g;f++)d.push(c.call(a,b[f]));return d}},"es6-impl","es3");$jscomp.owns=function(b,d){return Object.prototype.hasOwnProperty.call(b,d)};
$jscomp.polyfill("WeakMap",function(b){function d(b){$jscomp.owns(b,a)||$jscomp.defineProperty(b,a,{value:{}})}function c(a){var b=Object[a];b&&(Object[a]=function(a){d(a);return b(a)})}if(function(){if(!b||!Object.seal)return!1;try{var a=Object.seal({}),e=Object.seal({}),c=new b([[a,2],[e,3]]);if(2!=c.get(a)||3!=c.get(e))return!1;c.delete(a);c.set(e,4);return!c.has(a)&&4==c.get(e)}catch(p){return!1}}())return b;var a="$jscomp_hidden_"+Math.random().toString().substring(2);c("freeze");c("preventExtensions");
c("seal");var h=0,g=function(a){this.id_=(h+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};g.prototype.set=function(b,e){d(b);if(!$jscomp.owns(b,a))throw Error("WeakMap key fail: "+b);b[a][this.id_]=e;return this};g.prototype.get=function(b){return $jscomp.owns(b,a)?b[a][this.id_]:void 0};g.prototype.has=function(b){return $jscomp.owns(b,a)&&$jscomp.owns(b[a],this.id_)};g.prototype.delete=
function(b){return $jscomp.owns(b,a)&&$jscomp.owns(b[a],this.id_)?delete b[a][this.id_]:!1};return g},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_MAP=!1;
$jscomp.polyfill("Map",function(b){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),c=new b($jscomp.makeIterator([[a,"s"]]));if("s"!=c.get(a)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),f=d.next();if(f.done||f.value[0]!=a||"s"!=f.value[1])return!1;f=d.next();return f.done||4!=f.value[0].x||"t"!=f.value[1]||!d.next().done?!1:!0}catch(v){return!1}}())return b;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var d=new WeakMap,c=function(a){this.data_={};this.head_=g();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};c.prototype.set=function(b,c){var e=a(this,b);e.list||(e.list=this.data_[e.id]=[]);e.entry?e.entry.value=c:(e.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:b,value:c},e.list.push(e.entry),this.head_.previous.next=e.entry,this.head_.previous=e.entry,this.size++);return this};c.prototype.delete=
function(b){b=a(this,b);return b.entry&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.data_[b.id],b.entry.previous.next=b.entry.next,b.entry.next.previous=b.entry.previous,b.entry.head=null,this.size--,!0):!1};c.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};c.prototype.has=function(b){return!!a(this,b).entry};c.prototype.get=function(b){return(b=a(this,b).entry)&&b.value};c.prototype.entries=function(){return h(this,function(a){return[a.key,
a.value]})};c.prototype.keys=function(){return h(this,function(a){return a.key})};c.prototype.values=function(){return h(this,function(a){return a.value})};c.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};c.prototype[Symbol.iterator]=c.prototype.entries;var a=function(a,b){var c;c=b&&typeof b;"object"==c||"function"==c?d.has(b)?c=d.get(b):(c=""+ ++f,d.set(b,c)):c="p_"+b;var e=a.data_[c];if(e&&$jscomp.owns(a.data_,c))for(a=0;a<e.length;a++){var g=
e[a];if(b!==b&&g.key!==g.key||b===g.key)return{id:c,list:e,index:a,entry:g}}return{id:c,list:e,index:-1,entry:void 0}},h=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=a.next=a.head=a},f=0;return c},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.polyfill("Set",function(b){if(!$jscomp.ASSUME_NO_NATIVE_SET&&function(){if(!b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),a=new b($jscomp.makeIterator([c]));if(!a.has(c)||1!=a.size||a.add(c)!=a||1!=a.size||a.add({x:4})!=a||2!=a.size)return!1;var d=a.entries(),g=d.next();if(g.done||g.value[0]!=c||g.value[1]!=c)return!1;g=d.next();return g.done||g.value[0]==c||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:d.next().done}catch(f){return!1}}())return b;
$jscomp.initSymbol();$jscomp.initSymbolIterator();var d=function(b){this.map_=new Map;if(b){b=$jscomp.makeIterator(b);for(var a;!(a=b.next()).done;)this.add(a.value)}this.size=this.map_.size};d.prototype.add=function(b){this.map_.set(b,b);this.size=this.map_.size;return this};d.prototype.delete=function(b){b=this.map_.delete(b);this.size=this.map_.size;return b};d.prototype.clear=function(){this.map_.clear();this.size=0};d.prototype.has=function(b){return this.map_.has(b)};d.prototype.entries=function(){return this.map_.entries()};
d.prototype.values=function(){return this.map_.values()};d.prototype.keys=d.prototype.values;d.prototype[Symbol.iterator]=d.prototype.values;d.prototype.forEach=function(b,a){var c=this;this.map_.forEach(function(d){return b.call(a,d,d,c)})};return d},"es6-impl","es3");
(function(b){function d(a){var b=a.lastIndexOf("/");if(0>a.indexOf("\n")&&a.match(/^\/.*?\/[mi]*$/))try{return new RegExp(a.substring(1,b),a.substring(b+1))}catch(n){}}function c(){var b=w.val();w.html("").append("<option/>").append(Array.from(new Set(k.getNowCommonsRows(function(){return!0}).get().map(function(a){return a.uploaders})._flatten())).sort().map(function(b){return a("<option/>").val(b).text(b)[0]}));w.val(b)}var a=b.$,h=b.MDialog,g,f,e,m,p,A,v,w,q=function(){};q.prototype.match=function(){};
var x=function(a){this._user=a;return this};$jscomp.inherits(x,q);x.prototype.match=function(a){return a.uploaders.includes(this._user)};var y=function(a){this.match=a;return this};$jscomp.inherits(y,q);var r=function(){this.__matchOne=this._matchOne.bind(this);return this};$jscomp.inherits(r,q);r.prototype.match=function(a){a=a.texts.some(this.__matchOne);this._filter&&(a=this._filter(a));return a};r.prototype.setFilter=function(a){this._filter=a};var B=function(a){var b;b=r.call(this)||this;b._regex=
a;return b};$jscomp.inherits(B,r);B.prototype._matchOne=function(a){return a.match(this._regex)};var C=function(a){var b;b=r.call(this)||this;b._needle=a;return b};$jscomp.inherits(C,r);C.prototype._matchOne=function(a){return-1<a.toUpperCase().indexOf(this._needle)};var F=function(b){this._div=b;this.texts=a(".text",b).get().map(function(b){return a(b).text()});this.deleteLink=a(".delete",b)};F.prototype.toggleSelect=function(a){this._div.toggleClass("selected",a)};$jscomp.global.Object.defineProperties(F.prototype,
{deleteReason:{configurable:!0,enumerable:!0,get:function(){return this.deleteLink.data("reason")}},localName:{configurable:!0,enumerable:!0,get:function(){return this.deleteLink.data("name")}},nowCommonsLink:{configurable:!0,enumerable:!0,get:function(){return a(".nowcommons",this._div)}},selected:{configurable:!0,enumerable:!0,get:function(){return this._div.is(".selected")}},hasWarnings:{configurable:!0,enumerable:!0,get:function(){return a(".mark-problematic,.mark-keeplocal,.error-warning",this._div)[0]}},
hasLinks:{configurable:!0,enumerable:!0,get:function(){return a(".linkback",this._div)[0]}},needsTransfer:{configurable:!0,enumerable:!0,get:function(){return a(".oldver",this._div)[0]}},hasTalk:{configurable:!0,enumerable:!0,get:function(){return a(".talk",this._div)[0]}},uploaders:{configurable:!0,enumerable:!0,get:function(){return a(".user",this._div).get().map(function(b){return a(b).text()})}}});var k=function(){};k.prototype._run=function(){};k.prototype.run=function(){var a=this.test().get().slice(this.min(),
this.max());this.confirm(a.length)&&this._run(a);this.postRun()};k.prototype.postRun=function(){};k.prototype.confirm=function(){return!0};k.prototype.min=function(){return 0};k.prototype.max=function(){return Number.MAX_VALUE};k.prototype.test=function(){};k.getNowCommonsRows=function(b){return a(".nc-row").map(function(){var c=new F(a(this).prev(".nc-row").addBack());if(b(c))return c})};q=function(a){this._action=a;return this};$jscomp.inherits(q,k);q.prototype.run=function(){return this._action.run.call(this._action)};
q.prototype.test=function(){return this._action.test.call(this._action)};var l=function(a){return k.apply(this,arguments)||this};$jscomp.inherits(l,k);l.prototype.confirm=function(a){return b.confirm("Delete "+a+" files?")};l.prototype._run=function(a){this._markedRun(a)};l.prototype.test=function(){return k.getNowCommonsRows(function(a){return a.selected})};l.prototype.max=function(){return p.val()};l.prototype.postRun=function(){A.close()};var t=function(a){return k.apply(this,arguments)||this};
$jscomp.inherits(t,k);t.prototype.min=function(){return+e.val()};t.prototype.max=function(){return+m.val()};t.prototype._run=function(a){this.rows=a;a.forEach(function(a){a.toggleSelect(!0)})};t.prototype.test=function(){var b=a("#auto-mark-text").val().trim().replace(/\n/g,"").trim(),c=d(b),e=a("#auto-mark-text-omit").val().trim().replace(/\n/g,"").trim(),f=d(e),g=w.val().trim(),h=[];if(!b&&!g)throw"Please enter a value into the text box.";g&&h.push(new x(g));b&&h.push(c?new B(c):new C(b.toUpperCase()));
e&&(b=f?new B(f):new C(e.toUpperCase()),b.setFilter(function(a){return!a}),h.push(b));a("#include-warnings:checked")[0]||h.push(new y(function(a){return!a.hasWarnings}));a("#include-diff-name:checked")[0]||h.push(new y(function(a){return!a.hasLinks}));a("#include-multiple:checked")[0]||h.push(new y(function(a){return!a.needsTransfer}));a("#include-talk:checked")[0]||h.push(new y(function(a){return!a.hasTalk}));return k.getNowCommonsRows(function(a){return h.every(function(b){return b.match(a)})})};
t.prototype.postRun=function(){v.close()};var u=function(a){return l.apply(this,arguments)||this};$jscomp.inherits(u,l);u.prototype._markedRun=function(a){var c=this._getAutoOpenLink.bind(this);a.forEach(function(a){b.open(c(a).attr("href"),"_blank");a.toggleSelect(!1)})};var G=function(a){return l.apply(this,arguments)||this};$jscomp.inherits(G,l);G.prototype._markedRun=function(b){var c={};b.forEach(function(b){b=a(b.deleteLink);c[b.data("name")]=b.data("reason")});f.text(+f.text()+b.length);this.xDomain.postMessage(c)};
var D=function(a){return u.apply(this,arguments)||this};$jscomp.inherits(D,u);D.prototype._getAutoOpenLink=function(a){return a.deleteLink};var E=function(a){return u.apply(this,arguments)||this};$jscomp.inherits(E,u);E.prototype.confirm=function(a){return b.confirm("Delete "+a+" files?")};E.prototype._getAutoOpenLink=function(a){return a.nowCommonsLink};var z=new q(new D);b.XDomain.global(function(d){return $jscomp.executeAsyncGenerator(function(){function h(h,k){for(;;)switch(n){case 0:return n=
1,{value:d.promise(),done:!1};case 1:if(void 0===k){n=2;break}n=-1;throw k;case 2:f.text(0),b.topBar({css:{background:"#000099"},message:"Ajax delete detected"}),z._action=new G,a(function(){g.closest(".table-row").hide()}),d.addListener(function(d){f.text(f.text()-1);"success"===d.status?(b.topBar({css:{background:"#009999"},delay:2E3,message:d.page+": deleted"}),a(".selected a.delete").each(function(){var b=a(this);if(b.data("name")===d.page){b.closest(".selected").prev().addBack().remove();var c=
+m.attr("max")-1;[p,m,e].forEach(function(b){b=a(b);b.attr("max",c).val(Math.min(+b.val(),c))})}}),c()):b.topBar(d.page+": "+d.message)}),z._action.xDomain=d,n=-1;default:return{value:void 0,done:!0}}}var n=0,k={next:function(a){return h(a,void 0)},throw:function(a){return h(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();k[Symbol.iterator]=function(){return this};return k}())});b.observeDom(function(){return a.isReady}).progress(function(){a("#ready-count").html(Math.floor(a("input.file").length/
a("#files-count").val()*100))});a(b).on("beforeunload",function(){var b=a(".selected").length/2;if(b)return"You have "+b+" selections outstanding"});a(function(){var k=a(".close-buttons"),l;w=a("#auto-user");g=a("#auto-delete-nc");f=a(".ajax-count");e=a("#auto-mark-start");m=a("#auto-mark-count");p=a("#auto-delete-count");c();a("#doc-load-per,.ready-count,.bottom-buttons").toggle();a(".mark-auto").click(function(){a(this).closest(".nc-row").toggleClass("selected")});a("#clear-marks").click(function(){a(".selected").removeClass("selected")});
a(".delink,.mark-auto").click(function(a){a.preventDefault()});a("#auto-mark-text,#auto-mark-text-omit").on("keydown paste drop focus",function(){var b=this;setTimeout(function(){var c=a(b);c.toggleClass("regex",!!d(c.val()))},1)});g.change(function(){z._action=g.is(":checked")?new E:new D});a("#auto-mark-ok,#auto-mark-test").data("ncAction",new t);a("#auto-delete-ok,#auto-delete-test").data("ncAction",z);a("#auto-delete-ok,#auto-mark-ok").click(function(){try{a(this).data("ncAction").run()}catch(n){b.alert(n)}});
a("#auto-mark-test,#auto-delete-test").click(function(){try{a("#count").html(a(this).data("ncAction").test().length),l.open()}catch(n){b.alert(n)}});k.click(function(){a(".bottom-buttons-buttons > *").animate({width:"toggle"},350);k.toggleClass("glyphicon-menu-left")});l=new h("#auto-files-found");l.addCloseButton("#auto-delete-found-ok");A=new h("#auto-delete",{open:function(){var a=z.test().length;p.val(a).attr("max",a)}});A.addOpenButton("#auto-delete-open");A.addCloseButton("#auto-delete-cancel");
v=new h("#auto-mark");v.addOpenButton("#auto-mark-open");v.addCloseButton("#auto-mark-cancel")});return Promise})(window); //# sourceMappingURL=js/nowcommonslist.js.map
